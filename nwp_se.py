# -*- coding: utf-8 -*-
"""Untitled4.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1OuGylvlDtYChKTQjgSkuSNQcTXk8ZMul
"""

import openai
import requests
from bs4 import BeautifulSoup
import streamlit as st

# Set OpenAI API key
openai.api_key = "api key"

# Set Google Search Engine API key and ID
google_api_key = "api key"
google_cse_id = "engine id"

# Function to get suggested search query from Google Search Engine
def get_suggestion(query):
    suggestion = ""
    try:
        response = requests.get(f"https://www.googleapis.com/customsearch/v1?key={google_api_key}&cx={google_cse_id}&q={query}")
        if response.status_code == 200:
            results = response.json().get('items', [])
            if len(results) > 0:
                suggestion = results[0].get('title', "")
    except:
        pass
    return suggestion

# Streamlit web app
st.title("Next Word Prediction and Google Search Engine")

# Get input query from user
query = st.text_input("Enter your query:", "")

if query:
    # Predict next word using OpenAI's GPT model
    response = openai.Completion.create(
        engine="text-davinci-002",
        prompt=f"Please complete the following sentence:\n\n\"{query}____\"",
        max_tokens=1,
    )
    next_word = response.choices[0].text.strip()
    
    # Check if next word is valid, if not get a suggestion from Google Search Engine
    if next_word == "":
        next_word = get_suggestion(query)
    
    # Display next word and search results
    if next_word:
        st.write(f"Next word: {next_word}")
        
        # Get search results from Google
        response = requests.get(f"https://www.googleapis.com/customsearch/v1?key={google_api_key}&cx={google_cse_id}&q={query}+{next_word}")
        if response.status_code == 200:
            results = response.json().get('items', [])
            if len(results) > 0:
                st.write("Search results:")
                for result in results:
                    st.write(result['title'])
                    st.write(result['link'])
    else:
        st.write("Sorry, could not find a suitable next word.")

